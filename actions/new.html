<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>有事情喽</title>
    <link rel="stylesheet" href="../style/weui.min.css"/>
    <link rel="stylesheet" href="../style/common.css"/>
    <style type="text/css">
        .footer:before {
            border: 0;
        }
        .footer {
            padding-top: 0;
        }
        .footer a.weui_btn {
            width: 40%;
            margin-top: auto;
            margin-bottom: auto;
        }
    </style>
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.min.js"></script>
    <script src="../js/action.js"></script>
    <script type="text/javascript">
        $(function(){
            var action = getUrlParam("type") || "dining";
            $(".bd").load("./" + action + "_fragment.html", function(respond){
                if (!respond) return;
                $(".page_title").html(page_title);
                applyData();
            });

            $("#submit").on("click", function(){
                if (action === "memo") { //TODO: remove after it's ready
                    return;
                }
                $.post("./action.php", {
                    type: action,
                    data: loadData()
                }, function(respond){
                    console.log(respond);
                    !!respond && showToast();
                });
                /*$.ajax({
                    url: "./action.php",
                    type: "POST",
                    data: loadData(),
                    processData: false,  // 告诉jQuery不要去处理发送的数据
                    contentType: false   // 告诉jQuery不要去设置Content-Type请求头
                });*/
            });

            
        });
    </script>
</head>

<body>
    <div class="container">
        <div class="page slideIn cell">
            <div class="hd">
                <h1 class="page_title"></h1>
            </div>
            <div class="bd">
            </div>
            <div class="weui_cell footer">
                <a id="submit" class="weui_btn weui_btn_primary" href="javascript:;">完成</a>
                <a id="submit" class="weui_btn weui_btn_primary" href="../index.php">返回</a>
            </div>
        </div>
        <div id="toast" style="display: none;">
            <div class="weui_mask_transparent"></div>
            <div class="weui_toast">
                <i class="weui_icon_toast"></i>
                <p class="weui_toast_content">已完成</p>
            </div>
        </div>
    </div>
</body>