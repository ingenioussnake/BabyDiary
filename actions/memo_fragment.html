<div class="weui_cells weui_cells_form action_form">
    <div class="weui_cell">
        <div class="weui_cell_hd"><label class="weui_label" for="">日期</label></div>
        <div class="weui_cell_bd weui_cell_primary">
            <input id="date" class="weui_input" type="date" value="">
        </div>
    </div>
    <div class="weui_cell">
        <div class="weui_cell_hd"><label class="weui_label" for="">时间</label></div>
        <div class="weui_cell_bd weui_cell_primary">
            <input id="time" class="weui_input" type="time" placeholder="" value="">
        </div>
    </div>
    <div class="weui_cell">
        <div class="weui_cell_hd"><label class="weui_label">标题</label></div>
        <div class="weui_cell_bd weui_cell_primary">
            <input class="weui_input" type="text" id="title">
        </div>
    </div>
    <div class="weui_cell">
        <div class="weui_cell_hd"><label class="weui_label" for="">心情</label></div>
        <div class="weui_cell_bd weui_cell_primary">
            <textarea class="weui_textarea" placeholder="写下你的心情吧" id="memo"></textarea>
            <!-- <div class="weui_textarea_counter"><span>0</span>/200</div> -->
        </div>
    </div>
    <div class="weui_cell">
        <div class="weui_cell_bd weui_cell_primary">
            <div class="weui_uploader">
                <div class="weui_uploader_hd weui_cell">
                    <div class="weui_cell_bd weui_cell_primary">添加照片</div>
                    <!-- <div class="weui_cell_ft">0/2</div> -->
                </div>
                <div class="weui_uploader_bd">
                    <ul class="weui_uploader_files">
                        <!-- <li class="weui_uploader_file" style="background-image:url(http://shp.qpic.cn/weixinsrc_pic/pScBR7sbqjOBJomcuvVJ6iacVrbMJaoJZkFUIq4nzQZUIqzTKziam7ibg/)"></li> -->
                        <!-- <li class="weui_uploader_file weui_uploader_status" style="background-image:url(http://shp.qpic.cn/weixinsrc_pic/pScBR7sbqjOBJomcuvVJ6iacVrbMJaoJZkFUIq4nzQZUIqzTKziam7ibg/)">
                            <div class="weui_uploader_status_content">
                                <i class="weui_icon_warn"></i>
                            </div>
                        </li> -->
                        <!-- <li class="weui_uploader_file weui_uploader_status" style="background-image:url(http://shp.qpic.cn/weixinsrc_pic/pScBR7sbqjOBJomcuvVJ6iacVrbMJaoJZkFUIq4nzQZUIqzTKziam7ibg/)">
                            <div class="weui_uploader_status_content">50%</div>
                        </li> -->
                    </ul>
                    <div class="weui_uploader_input_wrp">
                        <input class="weui_uploader_input" type="file" accept="image/*" id="pics" multiple="">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<style type="text/css">
    .weui_uploader_file {
            position: relative;
        }
    .weui_uploader_file a.delete {
        width: 32px;
        height: 32px;
        background-image: url("../images/icons/icon_delete.png");
        background-size: contain;
        position: absolute;
        bottom: 0px;
        right: 0px;
    }
</style>
<script type="text/javascript">
    var page_title = "宝宝爱你咯",
        file_list = [],
        $form = $(".action_form"),
        $preview = $(".weui_uploader_files"),
        oFileReader, $img;
    $("#pics").on("change", function(e){
        for (var i = 0; i < this.files.length; i++) {
            oFileReader = new FileReader();
            oFileReader.onload = function (e) {
                $img = $("<li><a class='delete' href='javascript:;'></a></li>");
                $img.addClass("weui_uploader_file");
                $img.css("background-image", "url("+e.target.result+")");
                $preview.append($img);
            };
            oFileReader.readAsDataURL(this.files[i]);
            file_list.push(this.files[i]);
        }
    });
    $(".weui_uploader_files").on("click", "a.delete", function(e){
        $img = $(e.target).parent();
        var index = $img.index();
        file_list.splice(index, 1);
        $img.remove();
    });
    function applyData (data) {
        if (!data) {
            var curr = new Date();
            $("#date", $form).val(getDate(curr));
            $("#time", $form).val(getTime(curr));
        }
    }
    function loadData () {
        var data = new FormData();
        data.append("date", $("#date", $form).val());
        data.append("time", $("#time", $form).val());
        data.append("title", $("#title", $form).val());
        data.append("memo", $("#memo", $form).val());
        file_list.forEach(function(file){
            data.append("picture[]", file);
        });
        return data;
    }
</script>